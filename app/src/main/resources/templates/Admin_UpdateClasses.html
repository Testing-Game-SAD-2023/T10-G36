<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.com">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" href="../css/ViewClasses.css">
    <link rel="stylesheet" href="../css/searchForm.css">
</head>
<body>
  <!--  NAVBAR    -->
  <nav>
    <div class="wrapper">
      <!-- LOGO ADMIN -->
      <div class="logo"><a href="/Admin_Menu">Admin Menu</a></div>

      <input type="radio" name="slider" id="menu-btn">
      <input type="radio" name="slider" id="close-btn">
      <ul class="nav-links">
        <label for="close-btn" class="btn close-btn"><i class="fas fa-times"></i></label>
        <!-- NAVBAR - HOME -->
        <li><a href="/Admin_Menu">Home</a></li>

        <!-- NAVBAR - PLAY -->
        <li><a href="/Admin_Play">Gioca</a></li>

        <!-- NAVBAR - GAME MENU -->
        <li><a href="#" class="desktop-item">Game Menu</a>
          <input type="checkbox" id="showDrop">
          <label for="showDrop" class="mobile-item">Game Menu</label>
          <ul class="drop-menu">
            <li><a href="/Admin_ViewClasses">View Classes</a></li>
            <li><a href="/Admin_SearchClasses">Search Classes</a></li>
          </ul>
        </li>

        <!-- NAVBAR - GAME MANAGEMENT -->
        <li><a href="#" class="desktop-item">Game Management</a>
          <input type="checkbox" id="showMega">
          <label for="showMega" class="mobile-item">Game Management</label>
          <div class="mega-box">
            <div class="content">
              <div class="row">
                <img src="https://www.gameindustrycareerguide.com/wp-content/uploads/2021/05/best-programming-languages-for-games.jpg" alt="">
              </div>
              <div class="row">
                <header>Class Management</header>
                <ul class="mega-links">
                  <li><a href="/Admin_UploadClass">Upload Class</a></li>
                  <li><a href="/Admin_ManageClass">Manage Classes</a></li>
                  <li><a href="/Admin_AdvancedSearchClasses">Search Classes</a></li>
                </ul>
              </div>
              <div class="row">
                <header>User Management</header>
                <ul class="mega-links">
                  <li><a href="#">Register an User</a></li>
                  <li><a href="#">Delete an User</a></li>
                  <li><a href="#">Search an User</a></li>
                </ul>
              </div>
            </div>
          </div>
        </li>
        <li><a href="/">Esci</a></li>
      </ul>
      <label for="menu-btn" class="btn menu-btn"><i class="fas fa-bars"></i></label>
    </div>
  </nav>

<!--    CONTENUTO DELLA PAGINA  -->
<div class="container">
    <div class="text">Update Class</div>
    <form id="updateForm" method="PUT" th:attr="data-id=${id}">
        <div class="form-row">
            <div class="subText" style="width:800px; margin:0 auto;">LOC:</div>
            <div class="input-data">
                <input type="number" class="form-control" id="loc" name="loc" required>
            </div>
        </div>
        <div class="form-row" >
            <div class="subText" style="width:800px; margin:0 auto;">Complexity:</div>
            <div class="input-data">
                <select id="complexity" name="complexity" required>
                    <option selected value="" >Any</option>
                    <option value="SIMPLE">Simple</option>
                    <option value="MODERATE">Moderate</option>
                    <option value="COMPLEX">Complex</option>
                    <option value="INSANE">Insane</option>
                </select>
            </div>
        </div>
        <div class="form-row">
            <div class="subText" style="width:800px; margin:0 auto;">Last Update:</div>
            <div class="input-data">
                <input type="date" id="lastUpdate" name="lastUpdate" required>
            </div> 
        </div>
        <div class="form-row">
            <div class="subText" style="width:800px; margin:0 auto;">Opponent Recommended:</div>
            <div class="input-data">
                <select id="recommended" name="recommended">
                    <option value="">Any</option>
                    <option value="RANDOOP">Randoop</option>
                    <option value="EVOSUITE">EvoSuite</option>
                </select>
            </div>
        </div>
        <div class="form-row submit-btn">
            <div class="input-data" style="width:800px; margin:0 auto;">
               <div class="inner"></div>
               <input type="submit" value="       submit" class="form-submit-button">
            </div>
        </div>
    </form>
</div>


<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var submitButton = document.querySelector('.form-submit-button');

            submitButton.addEventListener('click', function(event) {
                var form = document.getElementById('updateForm');
                var id = form.getAttribute('data-id');
                event.preventDefault();

                var complexity = document.getElementById('complexity').value;
                var loc = document.getElementById('loc').value;
                var lastupdate = document.getElementById('lastUpdate').value;
                var recommended = document.getElementById('recommended').value;

                var data = {};

                if (complexity) {
                    data.complexity = complexity;
                } else {
                    data.complexity = null;
                }

                if (loc) {
                    data.loc = loc;
                } else {
                    data.loc = null;
                }

                if (lastupdate) {
                    data.lastupdate = lastupdate;
                } else {
                    data.lastupdate = null;
                }

                if (recommended) {
                    data.recommended = recommended;
                } else {
                    data.recommended = null;
                }

                axios.put('/admin/api/ModificaClasse/' + id, data)
                    .then(function(response) {
                        alert('Class updated successfully.');
                        window.location.href = '/Admin_ManageClass';
                    })
                    .catch(function(error) {
                        var errorMessage = "Error: ";
                        if (error.response && error.response.data) {
                            errorMessage += JSON.stringify(error.response.data);
                        } else {
                            errorMessage += error.message;
                        }
                        alert(errorMessage);
                    });
            });
        });
    </script>
</body>
</html>